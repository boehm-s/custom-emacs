<?php

require_once('includes/error_handling.php');

class sortController {
  public function insertion($array) {
    $err_handler = new Error_handler();
    $err = $err_handler->arr($array);
    if ($err["value"] == false)
      echo json_encode($err);

    $count = 0;
    $array_length = count($array);
    for ($i = 0; $i < $array_length; $i++) {
      $x = $array[$i];
      for ($j = $i; $j > 0 && $array[$j - 1] > $x; $j--) {
        $count++;
        $array[$j] = $array[$j - 1];
      }
      $array[$j] = $x;
    }
    echo json_encode((array("array" => $array, "count" => $count)));
  }

  public function selection($array) {
    $err_handler = new Error_handler();
    $err = $err_handler->arr($array);
    if ($err["value"] == false)
      echo json_encode($err);

    $count = 0;
    $array_length = count($array);
    for ($i = 0; $i < $array_length; $i++) {
      $min = $i;
      for ($j = $i + 1; $j < $array_length; $j++) {
        $count++;
        if ($array[$j] < $array[$min])
          $min = $j;
      }
      if ($min != $i)
        $array[$min] ^= $array[$i] ^= $array[$min] ^= $array[$i];
    }
    echo json_encode((array("array" => $array, "count" => $count)));
  }

  public function bubble($array) {
    $err_handler = new Error_handler();
    $err = $err_handler->arr($array);
    if ($err["value"] == false)
      echo json_encode($err);

    $count = 0;
    $array_length = count($array);
    for ($i = $array_length - 1; $i > 0; $i--) {
      for ($j = 0; $j < $i; $j++) {
        $count++;
        if ($array[$j + 1] < $array[$j])
          $array[$j] ^= $array[$j + 1] ^= $array[$j] ^= $array[$j + 1];
      }
    }
    echo json_encode((array("array" => $array, "count" => $count)));
  }

  public function bubble_opti($array) {
    $err_handler = new Error_handler();
    $err = $err_handler->arr($array);
    if ($err["value"] == false)
      echo json_encode($err);

    $count = 0;
    $array_length = count($array);
    for ($i = $array_length - 1; $i > 0; $i--) {
      $sorted = true;
      for ($j = 0; $j < $i; $j++) {
        $count++;
        if ($array[$j + 1] < $array[$j]) {
          $array[$j] ^= $array[$j + 1] ^= $array[$j] ^= $array[$j + 1];
          $sorted = false;
        }
      }
      if ($sorted)
        echo json_encode((array("array" => $array, "count" => $count)));
    }
    echo json_encode((array("array" => $array, "count" => $count)));
  }
}
