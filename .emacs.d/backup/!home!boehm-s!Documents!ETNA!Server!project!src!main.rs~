extern crate iron;
extern crate staticfile;
extern crate router;
extern crate mount;

use mount::Mount;
use router::Router;
use staticfile::Static;

use iron::prelude::*;
use iron::status;

use std::path::Path;

fn test(req: &mut Request) -> IronResult<Response> {
    println!("Running test handler, URL path: {}", req.url.path().join("/"));
    Ok(Response::with((status::Ok, "This request was routed (test succeded) !")))
}

fn main() {
    let mut router = Router::new();
    router
        .get("/test", test, "test");

    let mut mount = Mount::new();
    mount
        .mount("/", router)
        .mount("/html", Static::new(Path::new("index.html")))
        .mount("/js/", Static::new(Path::new("js/")));

    Iron::new(mount).http("127.0.0.1:3000").unwrap();
}
